<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Individual Comments</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* --- Your Original CSS (unchanged) --- */
    body{background:#0F1A2B;color:#D1CFC9;font-family:'Montserrat',sans-serif;}
    .box{background:#192c44;border-radius:12px;padding:20px;margin:10px;}
  </style>
</head>
<body>

<header>
  <div class="logo"><a href="ii.html"><img src="samvaadsetu.jpg" alt="Logo"></a></div>
  <div class="header-title">Individual Comments</div>
  <div class="hamburger-menu" onclick="openNav()">â˜°</div>
</header>

<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="i.html">Home</a>
  <a href="about.html">Contact Us</a>
  <a href="https://www.mca.gov.in/content/mca/global/en/home.html" target="_blank">MOCA</a>
  <a href="policy.html">Policy</a>
</div>

<div class="main-container">
  <div class="box">
    <h2>Summary</h2>
    <textarea id="commentSummary" style="width:100%;height:100px;background:#2D394C;color:#D1CFC9;"></textarea>
  </div>
  <div class="box">
    <h2>Sentiment</h2>
    <canvas id="sentimentPieChart"></canvas>
  </div>
  <div class="box comments-box full-width">
    <h2>Comment</h2>
    <div id="commentCard" style="padding:20px;background:#2D394C;border-radius:12px;"></div>
  </div>
</div>

<script>
async function loadComment(){
  const params=new URLSearchParams(window.location.search);
  const table=params.get("table");const id=params.get("id");
  if(!table||!id)return;

  const res=await fetch(http://localhost:5000/comment/${table}/${id});
  const data=await res.json();

  const res2=await fetch("http://localhost:5000/analyze_one",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:data.suggestion})});
  const analysis=await res2.json();

  document.getElementById("commentSummary").value=analysis.summary;

  let pos=0,neg=0,neu=0;
  if(analysis.sentiment==="Positive")pos=1;
  else if(analysis.sentiment==="Negative")neg=1;
  else neu=1;
  new Chart(document.getElementById("sentimentPieChart"),{type:"doughnut",data:{labels:["Positive","Negative","Neutral"],datasets:[{data:[pos,neg,neu],backgroundColor:["#28a745","#dc3545","#ffc107"]}]}});

  document.getElementById("commentCard").innerHTML=<p>${data.suggestion}</p><p><b>Summary:</b> ${analysis.summary}</p><p><b>Sentiment:</b> ${analysis.sentiment}</p>;
}
loadComment();

function openNav(){document.getElementById("mySidebar").style.width="250px";}
function closeNav(){document.getElementById("mySidebar").style.width="0";}
</script>
</body>
</html>
